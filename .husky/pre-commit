#!/bin/sh
echo "ğŸ” Detecting changes..."

STAGED_FILES=$(git diff --cached --name-only)

if echo "$STAGED_FILES" | grep -qE "^client/"; then
    echo "ğŸ¨ Client changes detected, running pre-commit hook..."
    npm exec --workspace client lint-staged
fi

if echo "$STAGED_FILES" | grep -qE "^server/"; then
    echo "ğŸ¨ Server changes detected, running pre-commit hook..."
    npm run format --workspace server
    npm run lint --workspace server -- --fix
    git add server/
fi

echo "âœ… Pre-commit checks completed!"
